<%- include('../layouts/header.ejs') %>

    <main class="main">
        <div class="page-header text-center" style="background-image: url('assets/images/page-header-bg.jpg')">
            <div class="container">
                <h1 class="page-title">My Account<span>Address</span></h1>
            </div>
        </div>
        <nav aria-label="breadcrumb" class="breadcrumb-nav mb-3">
            <div class="container">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/userhome">Home</a></li>
                    <li class="breadcrumb-item"><a href="shop">Shop</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Address</li>
                </ol>
            </div>
        </nav>
        <div class="page-content">
            <div class="dashboard">
                <div class="container">
                    <div class="row">
                        <aside class="col-md-4 col-lg-3">
                            <ul class="nav nav-dashboard flex-column mb-3 mb-md-0" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link " id="tab-dashboard-link" href="/profile"
                                        aria-selected="true">Profile</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="tab-orders-link" href="/orders" aria-controls="tab-orders"
                                        aria-selected="false">Orders</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="tab-wallet-link" href="/wallet" aria-controls="tab-wallet"
                                        aria-selected="false">Wallet</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link active" id="tab-address-link" href="/address"
                                        aria-selected="true">Adresses</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="tab-account-link" href="/accountDetails"
                                        aria-controls="tab-account" aria-selected="false">Account Details</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/logout">Sign Out</a>
                                </li>
                            </ul>
                        </aside>



                        <div class="col-md-8 col-lg-9">
                            <div class="tab-content">
                                <div class="tab-pane fade show active" id="tab-address" role="tabpanel"
                                    aria-labelledby="tab-address-link">
                                    <p>The following addresses will be used on the checkout page by default.</p>

                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="card card-dashboard">
                                                <div class="card-body">
                                                    <h3 class="card-title">Billing Address</h3>

                                                    <% address.forEach(data=>{%>

                                                    <p><strong><%=data.name%></strong></p>
                                                    <p><%=data.streetAddress%> <br><%=data.city%>, <%=data.state%>, <%=data.postalCode%><br></p>
                                                    <p>Phone: <%=data.mobile%></p>

                                                    <div>
                                                        <a href="/editAddress?id=<%= data._id %>"><button class="btn btn-primary btn-sm"><i
                                                            class="fas fa-edit"></i> Edit
                                                        </button></a>
                                                        <a href="#" onclick="confirmDelete('<%= data._id %>')">
                                                            <button class="btn btn-danger btn-sm">
                                                                <i class="fas fa-trash-alt"></i> Delete
                                                            </button>
                                                        </a>
                                                    </div>
                                                    <%})%> 
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <a href="/addAddress"><button class="btn btn-primary" id="addAddress">Add Address</button></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <%- include('../layouts/footer.ejs') %>

        </div>
        <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>
        <%- include('../layouts/mobilemenu.ejs') %>

        <script>
            function confirmDelete(addressId) {
                Swal.fire({
                    title: 'Are you sure?',
                    text: "You won't be able to revert this!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, delete it!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = `/deleteAddress?id=${addressId}`;
                    }
                });
            }
        </script>

        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/bootstrap.bundle.min.js"></script>
        <script src="assets/js/jquery.hoverIntent.min.js"></script>
        <script src="assets/js/jquery.waypoints.min.js"></script>
        <script src="assets/js/superfish.min.js"></script>
        <script src="assets/js/owl.carousel.min.js"></script>
        <script src="assets/js/main.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        </body>

        </html>